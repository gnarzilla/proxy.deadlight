# ------------  Makefile (located in v4.0/) -----------------
CC      := gcc
CFLAGS  := -Wall -Wextra -std=c11 -g

PKG_CFLAGS := $(shell pkg-config --cflags glib-2.0 gio-2.0 openssl)
PKG_LIBS   := $(shell pkg-config --libs   glib-2.0 gio-2.0 openssl)

# Grab every .c file under src/  (works with MSYS ‘wildcard’)
SRCS := $(wildcard src/*.c src/*/*.c src/*/*/*.c)
OBJS := $(SRCS:.c=.o)

TARGET := deadlight

$(TARGET): $(OBJS)
	$(CC) $(CFLAGS) $(OBJS) -o $@ $(PKG_LIBS)

# Compile each .c → matching .o inside the same directory
%.o : %.c deadlight.h
	$(CC) $(CFLAGS) $(PKG_CFLAGS) -c $< -o $@

.PHONY: run clean
run: $(TARGET)
	./$(TARGET)

clean:
	rm -f $(OBJS) $(TARGET)
# ------------------------------------------------------------
